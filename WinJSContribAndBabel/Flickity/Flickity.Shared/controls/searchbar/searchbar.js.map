{"version":3,"sources":["Flickity/Flickity.Shared/controls/searchbar/searchbar.es6.js"],"names":[],"mappings":"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","file":"Flickity/Flickity.Shared/controls/searchbar/searchbar.js","sourcesContent":["/// <reference path=\"../../js/_reference.js\" />\r\n\r\n(function () {\r\n    \"use strict\";\r\n\r\n    var SearchBarCtor = WinJS.UI.Pages.define(\"/controls/searchbar/searchbar.html\", {\r\n    \tprocessed: function (element, options) {\r\n    \t\tvar ctrl = this;\r\n    \t\tctrl.mainHeader = document.getElementById('appheader');    \t\t\r\n    \t\tctrl.eventTracker.addEvent(ctrl.searchInput, 'focus', ctrl.show.bind(ctrl));    \t\t\r\n    \t\tctrl.loadLastSearches();\r\n\r\n    \t\tctrl.recentItemsPromise = Flickity.Api.recent(0, 80).then(function (items) {\r\n    \t\t\tctrl.recentItemsList.itemDataSource = new WinJS.Binding.List(items.photos.photo).dataSource;\r\n    \t\t\tctrl.recentItemsList.oniteminvoked = function (arg) {\r\n    \t\t\t\targ.detail.itemPromise.then(function (item) {\r\n    \t\t\t\t\tctrl.hide();\r\n    \t\t\t\t\tWinJS.Navigation.navigate('/pages/detail/detail.html', { picture: item.data });\r\n    \t\t\t\t});\r\n    \t\t\t};\r\n    \t\t}, ctrl.recentItemsError.bind(ctrl));\r\n\r\n    \t\tctrl.eventTracker.addEvent(WinJS.Application, 'search', function (arg) {\r\n    \t\t\tctrl.runSearch(arg.term);\r\n    \t\t});\r\n    \t},\r\n\r\n    \trecentItemsError: function (err) {\r\n    \t\tconsole.error(err);\r\n    \t},\r\n\r\n    \tloadLastSearches: function () {\r\n    \t\tvar ctrl = this;\r\n    \t\tvar lastSearches = localStorage['lastSearches'];\r\n    \t\tif (!lastSearches)\r\n    \t\t\tlastSearches = [];\r\n    \t\telse\r\n    \t\t\tlastSearches = JSON.parse(lastSearches);\r\n\r\n    \t\tctrl.lastSearches = lastSearches;\r\n    \t\tctrl.lastsearchItems.innerHTML = '';\r\n\r\n    \t\tlastSearches.forEach(function (s) {\r\n    \t\t\tvar item = document.createElement('SPAN');\r\n    \t\t\titem.className = 'search-term';\r\n    \t\t\titem.innerText = s;\r\n\t\t\t\tWinJSContrib.UI.tap(item, function () {\r\n    \t\t\t\tctrl.runSearch(s);\r\n    \t\t\t});\r\n    \t\t\tctrl.lastsearchItems.appendChild(item);\r\n    \t\t});\r\n    \t},\r\n\r\n    \taddSearchTerm: function (s) {\r\n    \t\tvar ctrl = this;\r\n    \t\twhile (ctrl.lastSearches.indexOf(s) >= 0) {\r\n    \t\t\tvar idx = ctrl.lastSearches.indexOf(s);\r\n    \t\t\tctrl.lastSearches.splice(idx, 1);\r\n    \t\t}\r\n    \t\tctrl.lastSearches.splice(0, 0, s);\r\n    \t\tlocalStorage['lastSearches'] = JSON.stringify(ctrl.lastSearches.slice(0, 10));\r\n    \t},\r\n\r\n    \trunSearchFromInput: function () {\r\n    \t\tvar ctrl = this;\r\n    \t\tctrl.runSearch(ctrl.searchInput.value);\r\n    \t},\r\n\r\n    \trunSearch: function (searchTerm) {\r\n    \t\tvar ctrl = this;\r\n    \t\tif (searchTerm && searchTerm.length > 2) {\r\n    \t\t\tctrl.searchInput.value = searchTerm;\r\n    \t\t\tctrl.element.classList.add('hasSearch');\r\n    \t\t\tctrl.addSearchTerm(searchTerm);\r\n    \t\t\tctrl.searchInput.blur();\r\n    \t\t\tctrl.hide();\r\n    \t\t\tsetImmediate(function () {\r\n    \t\t\t\tWinJS.Navigation.navigate('/pages/home/home.html', { search: ctrl.searchInput.value });\r\n    \t\t\t\tctrl.loadLastSearches();\r\n    \t\t\t});\r\n\r\n    \t\t}\r\n    \t},\r\n\r\n    \tshow: function () {\r\n    \t\tvar ctrl = this;\r\n    \t\t\r\n    \t\tctrl.mainHeader.classList.add('expanded');\r\n    \t\tsetTimeout(function () {\r\n    \t\t\tctrl.recentBlock.style.opacity = '0';\r\n    \t\t\tctrl.recentItemsList.element.style.display = '';\r\n    \t\t\tWinJS.UI.Animation.fadeIn(ctrl.recentBlock);\r\n    \t\t}, 300);\r\n    \t},\r\n\r\n    \thide: function () {\r\n    \t\tvar ctrl = this;\r\n\r\n    \t\tWinJS.UI.Animation.fadeOut(ctrl.recentBlock).then(function () {\r\n    \t\t\tctrl.recentItemsList.element.style.display = 'none';\r\n    \t\t\tctrl.searchInput.blur();\r\n    \t\t\tctrl.mainHeader.classList.remove('expanded');\r\n    \t\t});\r\n    \t}\r\n    });\r\n\r\n    WinJS.Namespace.define('Flickity.UI', { SearchBar: SearchBarCtor });\r\n})();\r\n"],"sourceRoot":"/source/"}