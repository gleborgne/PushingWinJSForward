{"version":3,"sources":["searchbar.es6.js"],"names":[],"mappings":"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","file":"Flickity/Flickity.Shared/controls/searchbar/searchbar.js","sourcesContent":["/// <reference path=\"../../js/_reference.js\" />\r\n\r\n(function () {\r\n    \"use strict\";\r\n\r\n    class SearchBarControl {\r\n        constructor(element, options){\r\n        }\r\n\r\n        processed(element, options) {\r\n        \tvar ctrl = this;\r\n\r\n            ctrl.mainHeader = document.getElementById('appheader');         \r\n            ctrl.eventTracker.addEvent(ctrl.searchInput, 'focus', ctrl.show.bind(ctrl));            \r\n            ctrl.loadLastSearches();\r\n\r\n            ctrl.recentItemsPromise = Flickity.Api.recent(0, 80).then(function (items) {\r\n                ctrl.recentItemsList.itemDataSource = new WinJS.Binding.List(items.photos.photo).dataSource;\r\n                ctrl.recentItemsList.oniteminvoked = function (arg) {\r\n                    arg.detail.itemPromise.then(function (item) {\r\n                        ctrl.hide();\r\n                        WinJS.Navigation.navigate('/pages/detail/detail.html', { picture: item.data });\r\n                    });\r\n                };\r\n            }, ctrl.recentItemsError.bind(ctrl));\r\n\r\n            ctrl.eventTracker.addEvent(WinJS.Application, 'search', function (arg) {\r\n                ctrl.runSearch(arg.term);\r\n            });\r\n        }\r\n\r\n        recentItemsError(err) {\r\n            console.error(err);\r\n        }\r\n\r\n        loadLastSearches() {\r\n            var ctrl = this;\r\n            var lastSearches = localStorage['lastSearches'];\r\n            if (!lastSearches)\r\n                lastSearches = [];\r\n            else\r\n                lastSearches = JSON.parse(lastSearches);\r\n\r\n            ctrl.lastSearches = lastSearches;\r\n            ctrl.lastsearchItems.innerHTML = '';\r\n\r\n            lastSearches.forEach((s) => {\r\n                var item = document.createElement('SPAN');\r\n                item.className = 'search-term';\r\n                item.innerText = s;\r\n                WinJSContrib.UI.tap(item, () => {\r\n                    this.runSearch(s);\r\n                });\r\n                ctrl.lastsearchItems.appendChild(item);\r\n            });\r\n        }\r\n\r\n        addSearchTerm(s) {\r\n            var ctrl = this;\r\n            while (ctrl.lastSearches.indexOf(s) >= 0) {\r\n                var idx = ctrl.lastSearches.indexOf(s);\r\n                ctrl.lastSearches.splice(idx, 1);\r\n            }\r\n            ctrl.lastSearches.splice(0, 0, s);\r\n            localStorage['lastSearches'] = JSON.stringify(ctrl.lastSearches.slice(0, 10));\r\n        }\r\n\r\n        runSearchFromInput() {\r\n            var ctrl = this;\r\n            ctrl.runSearch(ctrl.searchInput.value);\r\n        }\r\n\r\n        runSearch(searchTerm) {\r\n            var ctrl = this;\r\n            if (searchTerm && searchTerm.length > 2) {\r\n                ctrl.searchInput.value = searchTerm;\r\n                ctrl.element.classList.add('hasSearch');\r\n                ctrl.addSearchTerm(searchTerm);\r\n                ctrl.searchInput.blur();\r\n                ctrl.hide();\r\n                setImmediate(() => {\r\n                    WinJS.Navigation.navigate('/pages/home/home.html', { search: ctrl.searchInput.value });\r\n                    ctrl.loadLastSearches();\r\n                });\r\n\r\n            }\r\n        }\r\n\r\n        show() {\r\n            var ctrl = this;\r\n            \r\n            ctrl.mainHeader.classList.add('expanded');\r\n            setTimeout(() => {\r\n                ctrl.recentBlock.style.opacity = '0';\r\n                ctrl.recentItemsList.element.style.display = '';\r\n                WinJS.UI.Animation.fadeIn(ctrl.recentBlock);\r\n            }, 300);\r\n        }\r\n\r\n        hide() {\r\n            var ctrl = this;\r\n\r\n            WinJS.UI.Animation.fadeOut(ctrl.recentBlock).then(function () {\r\n                ctrl.recentItemsList.element.style.display = 'none';\r\n                ctrl.searchInput.blur();\r\n                ctrl.mainHeader.classList.remove('expanded');\r\n            });\r\n        }\r\n    }\r\n\r\n    var SearchBarCtor = WinJS.UI.Pages.define(\"/controls/searchbar/searchbar.html\", SearchBarControl);\r\n\r\n    WinJS.Namespace.define('Flickity.UI', { SearchBar: SearchBarCtor});\r\n})();\r\n"],"sourceRoot":" "}